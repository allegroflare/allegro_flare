properties:


  - name: font_bin
    type: AllegroFlare::FontBin*
    init_with: nullptr
    constructor_arg: true

  - name: bitmap_bin
    type: AllegroFlare::BitmapBin*
    init_with: nullptr
    constructor_arg: true

  - name: dialog_box
    type: AllegroFlare::Elements::DialogBoxes::Base*
    init_with: nullptr
    constructor_arg: true


functions:


  - name: render
    guards:
      - al_is_system_installed()
      - al_is_primitives_addon_initialized()
      - al_get_current_display()
      - dialog_box
      - al_is_font_addon_initialized()
      - al_is_ttf_addon_initialized()
      - font_bin
    body: |
      float standard_dialog_box_x = 1920/2;
      float standard_dialog_box_y = 1080/8*6;
      float standard_dialog_box_width = 1920/2;
      float standard_dialog_box_height = 1080/5;
  
      if (dialog_box->is_type("Choice"))
      {
         AllegroFlare::Placement2D place{
            standard_dialog_box_x,
            standard_dialog_box_y,
            standard_dialog_box_width,
            standard_dialog_box_height,
         };

         AllegroFlare::Elements::DialogBoxes::Choice* choice_dialog_box =
            dynamic_cast<AllegroFlare::Elements::DialogBoxes::Choice*>(dialog_box);

         AllegroFlare::Elements::DialogBoxRenderers::ChoiceRenderer choice_dialog_box_renderer(
            font_bin,
            bitmap_bin,
            choice_dialog_box,
            place.size.x,
            place.size.y
         );

         place.start_transform();
         choice_dialog_box_renderer.render();
         place.restore_transform();
      }
      else if (dialog_box->is_type("YouGotAnItem"))
      {
         AllegroFlare::Placement2D place{ 1920/2, 1080/2, 400, 420 };

         AllegroFlare::Elements::DialogBoxes::YouGotAnItem* you_got_an_item_dialog_box =
            dynamic_cast<AllegroFlare::Elements::DialogBoxes::YouGotAnItem*>(dialog_box);

         AllegroFlare::Elements::DialogBoxRenderers::YouGotAnItemRenderer you_got_an_item_dialog_box_renderer(
            font_bin,
            bitmap_bin,
            you_got_an_item_dialog_box->get_item_name(),
            you_got_an_item_dialog_box->get_item_bitmap_identifier(),
            you_got_an_item_dialog_box->infer_age(),
            place.size.x,
            place.size.y
         );

         place.start_transform();
         you_got_an_item_dialog_box_renderer.render();
         place.restore_transform();
      }
      else if (dialog_box->is_type("Basic"))
      {
         AllegroFlare::Placement2D place{
            standard_dialog_box_x,
            standard_dialog_box_y,
            standard_dialog_box_width,
            standard_dialog_box_height,
         };

         AllegroFlare::Elements::DialogBoxes::Basic* basic_dialog_box =
            dynamic_cast<AllegroFlare::Elements::DialogBoxes::Basic*>(dialog_box);

         AllegroFlare::Elements::DialogBoxRenderers::BasicRenderer basic_dialog_box_renderer(font_bin);

         basic_dialog_box_renderer.set_current_page_text(basic_dialog_box->get_current_page_text());
         basic_dialog_box_renderer.set_num_revealed_characters(basic_dialog_box->get_num_revealed_characters());
         basic_dialog_box_renderer.set_is_finished(basic_dialog_box->get_finished());
         basic_dialog_box_renderer.set_page_is_finished(basic_dialog_box->get_page_finished());
         basic_dialog_box_renderer.set_page_finished_at(basic_dialog_box->get_page_finished_at());
         basic_dialog_box_renderer.set_at_last_page(basic_dialog_box->at_last_page());

         place.start_transform();
         basic_dialog_box_renderer.render();
         place.restore_transform();
      }
      else
      {
         // TODO include this:
         //std::cout << "Unrecognized dialog box type:: " + dialog_box->get_type();
         //throw std::runtime_error("Unrecognized dialog box type:: " + dialog_box->get_type());
      }

      return;
    body_dependency_symbols:
      - AllegroFlare::Placement2D
      - al_is_system_installed
      - al_is_primitives_addon_initialized
      - al_draw_filled_rounded_rectangle
      - al_color_html
      - AllegroFlare::Elements::DialogBoxFrame
      - AllegroFlare::Elements::DialogBoxes::Basic*
      - AllegroFlare::Elements::DialogBoxes::Choice*
      - AllegroFlare::Elements::DialogBoxes::YouGotAnItem*
      - AllegroFlare::Elements::DialogBoxRenderers::BasicRenderer
      - AllegroFlare::Elements::DialogBoxRenderers::ChoiceRenderer
      - AllegroFlare::Elements::DialogBoxRenderers::YouGotAnItemRenderer


dependencies:


  - symbol: ALLEGRO_FONT*
    headers: [ allegro5/allegro.h ]
  - symbol: al_is_system_installed
    headers: [ allegro5/allegro.h ]
  - symbol: al_get_current_display
    headers: [ allegro5/allegro.h ]
  - symbol: al_color_html
    headers: [ allegro5/allegro_color.h ]
  - symbol: al_is_primitives_addon_initialized
    headers: [ allegro5/allegro_primitives.h ]
  - symbol: al_draw_filled_rounded_rectangle
    headers: [ allegro5/allegro_primitives.h ]
  - symbol: Blast::StringJoiner
    headers: [ Blast/StringJoiner.hpp ]
  - symbol: AllegroFlare::BitmapBin*
    headers: [ AllegroFlare/BitmapBin.hpp ]
  - symbol: AllegroFlare::FontBin*
    headers: [ AllegroFlare/FontBin.hpp ]
  - symbol: AllegroFlare::Elements::DialogBoxes::Base*
    headers: [ AllegroFlare/Elements/DialogBoxes/Base.hpp ]
  - symbol: AllegroFlare::Elements::DialogBoxes::Basic*
    headers: [ AllegroFlare/Elements/DialogBoxes/Basic.hpp ]
  - symbol: AllegroFlare::Placement2D
    headers: [ AllegroFlare/Placement2D.hpp ]
  - symbol: AllegroFlare::Elements::DialogBoxFrame
    headers: [ AllegroFlare/Elements/DialogBoxFrame.hpp ]
  - symbol: AllegroFlare::Elements::DialogBoxes::Choice*
    headers: [ AllegroFlare/Elements/DialogBoxes/Choice.hpp ]
  - symbol: AllegroFlare::Elements::DialogBoxes::YouGotAnItem*
    headers: [ AllegroFlare/Elements/DialogBoxes/YouGotAnItem.hpp ]
  - symbol: AllegroFlare::Elements::DialogBoxRenderers::ChoiceRenderer
    headers: [ AllegroFlare/Elements/DialogBoxRenderers/ChoiceRenderer.hpp ]
  - symbol: AllegroFlare::Elements::DialogBoxRenderers::YouGotAnItemRenderer
    headers: [ AllegroFlare/Elements/DialogBoxRenderers/YouGotAnItemRenderer.hpp ]
  - symbol: AllegroFlare::Elements::DialogBoxRenderers::BasicRenderer
    headers: [ AllegroFlare/Elements/DialogBoxRenderers/BasicRenderer.hpp ]



